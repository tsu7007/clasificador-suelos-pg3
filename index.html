<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clasificador de Suelos PG-3</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --color-white: rgba(255, 255, 255, 1);
            --color-black: rgba(0, 0, 0, 1);
            --color-cream-50: rgba(252, 252, 249, 1);
            --color-gray-300: rgba(167, 169, 169, 1);
            --color-slate-500: rgba(98, 108, 113, 1);
            --color-brown-600: rgba(94, 82, 64, 1);
            --color-charcoal-700: rgba(31, 33, 33, 1);
            --color-charcoal-800: rgba(38, 40, 40, 1);
            --color-slate-900: rgba(19, 52, 59, 1);
            --color-teal-500: rgba(33, 128, 141, 1);
            --color-teal-600: rgba(29, 116, 128, 1);
            --color-red-500: rgba(192, 21, 47, 1);
            --color-orange-500: rgba(168, 75, 47, 1);

            --color-bg-primary: var(--color-cream-50);
            --color-text-primary: var(--color-slate-900);
            --color-text-secondary: var(--color-slate-500);
            --color-primary: var(--color-teal-500);
            --color-primary-hover: var(--color-teal-600);
            --color-border: rgba(94, 82, 64, 0.2);
            --color-surface: rgba(255, 255, 253, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--color-bg-primary);
            color: var(--color-text-primary);
            line-height: 1.6;
        }

        body {
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--color-border);
            padding-bottom: 20px;
        }

        h1 {
            font-size: 28px;
            color: var(--color-slate-900);
            margin-bottom: 8px;
        }

        .subtitle {
            color: var(--color-text-secondary);
            font-size: 14px;
        }

        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .card h2 {
            font-size: 18px;
            margin-bottom: 20px;
            color: var(--color-slate-900);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 18px;
        }

        label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 6px;
            color: var(--color-slate-900);
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--color-border);
            border-radius: 6px;
            font-size: 13px;
            background: white;
            color: var(--color-text-primary);
            font-family: inherit;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(33, 128, 141, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .form-row-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 25px;
        }

        button {
            flex: 1;
            padding: 12px 16px;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--color-primary-hover);
        }

        .btn-primary:disabled {
            background: var(--color-gray-300);
            cursor: not-allowed;
        }

        .btn-secondary {
            background: rgba(94, 82, 64, 0.12);
            color: var(--color-text-primary);
        }

        .btn-secondary:hover {
            background: rgba(94, 82, 64, 0.2);
        }

        .result-box {
            background: linear-gradient(135deg, rgba(33, 128, 141, 0.08), rgba(33, 128, 141, 0.04));
            border-left: 4px solid var(--color-primary);
            padding: 18px;
            border-radius: 6px;
            margin-top: 20px;
            display: none;
        }

        .result-box.visible {
            display: block;
        }

        .result-box h3 {
            font-size: 13px;
            color: var(--color-text-secondary);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .result-box .classification {
            font-size: 24px;
            font-weight: bold;
            color: var(--color-primary);
            margin-bottom: 12px;
        }

        .result-box .details {
            font-size: 12px;
            color: var(--color-text-secondary);
            line-height: 1.8;
        }

        .chart-container {
            position: relative;
            width: 100%;
            height: 500px;
            margin-top: 15px;
            border: 1px solid var(--color-border);
            border-radius: 6px;
            background: white;
            padding: 10px;
        }

        .table-wrapper {
            margin-top: 40px;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        thead {
            background: rgba(94, 82, 64, 0.08);
        }

        th {
            padding: 12px 8px;
            text-align: left;
            font-weight: 500;
            color: var(--color-slate-900);
            border-bottom: 2px solid var(--color-border);
        }

        td {
            padding: 12px 8px;
            border-bottom: 1px solid var(--color-border);
        }

        tr:hover {
            background: rgba(94, 82, 64, 0.04);
        }

        .action-buttons {
            display: flex;
            gap: 6px;
        }

        .btn-sm {
            padding: 6px 10px;
            font-size: 11px;
            border: 1px solid var(--color-border);
            background: white;
            color: var(--color-text-primary);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-sm:hover {
            background: rgba(94, 82, 64, 0.1);
        }

        .btn-delete {
            color: var(--color-red-500);
        }

        .btn-delete:hover {
            background: rgba(192, 21, 47, 0.08);
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .badge-seleccionado {
            background: rgba(33, 128, 141, 0.15);
            color: var(--color-primary);
        }

        .badge-adecuado {
            background: rgba(34, 197, 94, 0.15);
            color: #22c55e;
        }

        .badge-tolerable {
            background: rgba(234, 179, 8, 0.15);
            color: #eab308;
        }

        .badge-marginal {
            background: rgba(168, 75, 47, 0.15);
            color: var(--color-orange-500);
        }

        .badge-inadecuado {
            background: rgba(192, 21, 47, 0.15);
            color: var(--color-red-500);
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--color-text-secondary);
        }

        .empty-state p {
            font-size: 14px;
        }

        .info-text {
            background: rgba(33, 128, 141, 0.05);
            border-left: 3px solid var(--color-primary);
            padding: 12px 15px;
            border-radius: 4px;
            font-size: 12px;
            color: var(--color-text-secondary);
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .sieve-group {
            background: rgba(33, 128, 141, 0.03);
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 15px;
        }

        .sieve-grid-5 {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
        }

        .sieve-label {
            font-size: 11px;
            text-align: center;
            margin-bottom: 4px;
            font-weight: 500;
            color: var(--color-text-primary);
        }
    </style>
</head>
<body>
    <header>
        <h1>‚öôÔ∏è Clasificador de Suelos PG-3</h1>
        <p class="subtitle">Normativa de Carreteras - Sistema Espa√±ol</p>
    </header>

    <div class="container">
        <!-- ENTRADA DE DATOS -->
        <div class="card">
            <h2>üìã Datos del Suelo</h2>
            
            <div class="info-text">
                Introduce los par√°metros del suelo. LP/IP se calcula autom√°ticamente seg√∫n lo que introduzcas.
            </div>

            <form id="suelo-form">
                <div class="form-group">
                    <label for="nombre">Nombre del Suelo</label>
                    <input type="text" id="nombre" placeholder="ej: Suelo A, Muestra 1" required>
                </div>

                <div class="form-group">
                    <label>Par√°metros de Plasticidad</label>
                    <div class="form-row">
                        <div>
                            <label for="ll">LL (L√≠mite L√≠quido %)</label>
                            <input type="number" id="ll" placeholder="0" step="0.1" required>
                        </div>
                        <div>
                            <label for="ip">IP (√çndice Plasticidad %)</label>
                            <input type="number" id="ip" placeholder="0 o dejar vac√≠o" step="0.1">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>o LP (si prefieres introducir este)</label>
                    <div class="form-row">
                        <div>
                            <label for="lp">LP (L√≠mite Pl√°stico %)</label>
                            <input type="number" id="lp" placeholder="0 o dejar vac√≠o" step="0.1">
                        </div>
                        <div>
                            <label for="ipCalculado">IP (Calculado autom√°ticamente)</label>
                            <input type="number" id="ipCalculado" placeholder="Calculado" readonly>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="mo">MO (Materia Org√°nica %)</label>
                    <input type="number" id="mo" placeholder="0" step="0.1" required>
                </div>

                <div class="form-group">
                    <label for="ss">SS (Sales Solubles %)</label>
                    <input type="number" id="ss" placeholder="0" step="0.1" required>
                </div>

                <div class="form-group">
                    <label for="hinchamiento">Hinchamiento (%)</label>
                    <input type="number" id="hinchamiento" placeholder="0" step="0.01" required>
                </div>

                <div class="form-group">
                    <label>An√°lisis Granulom√©trico - Tamices</label>
                    <div class="sieve-group">
                        <div class="sieve-grid-5">
                            <div>
                                <div class="sieve-label"># 20</div>
                                <input type="number" class="sieve-input" id="sieve-20" placeholder="%" step="0.1">
                            </div>
                            <div>
                                <div class="sieve-label"># 10</div>
                                <input type="number" class="sieve-input" id="sieve-10" placeholder="%" step="0.1">
                            </div>
                            <div>
                                <div class="sieve-label"># 2</div>
                                <input type="number" class="sieve-input" id="sieve-2" placeholder="%" step="0.1">
                            </div>
                            <div>
                                <div class="sieve-label"># 0.4</div>
                                <input type="number" class="sieve-input" id="sieve-04" placeholder="%" step="0.1">
                            </div>
                            <div>
                                <div class="sieve-label"># 0.08 (Finos)</div>
                                <input type="number" class="sieve-input" id="sieve-008" placeholder="%" step="0.1" required>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="cbr">CBR</label>
                    <input type="number" id="cbr" placeholder="0" step="0.1" required>
                </div>

                <div class="button-group">
                    <button type="submit" class="btn-primary">Clasificar Suelo</button>
                    <button type="reset" class="btn-secondary">Limpiar</button>
                </div>

                <div id="resultado" class="result-box">
                    <h3>Clasificaci√≥n</h3>
                    <div class="classification" id="classResult">‚Äî</div>
                    <div class="details" id="classDetails"></div>
                </div>
            </form>
        </div>

        <!-- GR√ÅFICA DE CASAGRANDE -->
        <div class="card">
            <h2>üìä Gr√°fica de Casagrande (PG-3)</h2>
            <div class="chart-container">
                <canvas id="grafica"></canvas>
            </div>
            <p style="font-size: 11px; color: var(--color-text-secondary); margin-top: 12px; text-align: center;">
                Punto rojo = Suelo actual | Zonas coloreadas = Clasificaci√≥n PG-3 | Punto fuera = Inadecuado
            </p>
        </div>
    </div>

    <!-- TABLA DE HIST√ìRICO -->
    <div class="table-wrapper">
        <h2 style="margin-bottom: 20px; color: var(--color-slate-900);">üìà Hist√≥rico de Clasificaciones</h2>
        <div id="tabla-container">
            <div class="empty-state">
                <p>No hay suelos clasificados a√∫n. Introduce los datos y haz clic en "Clasificar Suelo".</p>
            </div>
        </div>
    </div>

    <script>
        let suelos = [];
        let suloActual = null;
        let chartInstance = null;

        const form = document.getElementById('suelo-form');
        const llInput = document.getElementById('ll');
        const ipInput = document.getElementById('ip');
        const lpInput = document.getElementById('lp');
        const ipCalculado = document.getElementById('ipCalculado');
        const chartCanvas = document.getElementById('grafica');

        // C√°lculo bidireccional LP/IP
        function calcularPlasticidad() {
            const ll = parseFloat(llInput.value) || 0;
            const ip = parseFloat(ipInput.value);
            const lp = parseFloat(lpInput.value);

            if (!isNaN(ip) && ip >= 0) {
                const lpCalculado = ll - ip;
                lpInput.value = lpCalculado >= 0 ? lpCalculado.toFixed(1) : '';
                ipCalculado.value = ip.toFixed(1);
            } else if (!isNaN(lp) && lp >= 0) {
                const ipCalculado2 = ll - lp;
                ipCalculado.value = ipCalculado2 >= 0 ? ipCalculado2.toFixed(1) : '';
                ipInput.value = '';
            } else {
                ipCalculado.value = '';
                ipInput.value = '';
                lpInput.value = '';
            }

            dibujarGrafica();
        }

        llInput.addEventListener('input', calcularPlasticidad);
        ipInput.addEventListener('input', calcularPlasticidad);
        lpInput.addEventListener('input', calcularPlasticidad);

        // Clasificaci√≥n seg√∫n PG-3
        function clasificarSuelo(ll, lp, ip, mo, ss, hinchamiento, finos, cbr) {
            const lineA = 0.73 * (ll - 20);
            
            let clasif1 = 'Inadecuado';
            if (mo <= 0.2 && ss <= 0.2 && hinchamiento <= 0.2 && finos <= 25 && ll <= 30 && ip <= 10) {
                clasif1 = 'Seleccionado';
            } else if (mo <= 1 && ss <= 0.2 && hinchamiento <= 0.2 && finos <= 35 && ll <= 40 && (ll <= 30 || ip >= 4)) {
                clasif1 = 'Adecuado';
            } else if (mo <= 2 && ss <= 1 && hinchamiento <= 2.5 && finos <= 50 && ll <= 65 && (ll <= 40 || ip >= lineA)) {
                clasif1 = 'Tolerable';
            } else if (mo <= 5 && ss <= 0.5 && hinchamiento <= 2.0 && finos <= 50 && ll <= 90 && ip <= (lineA + 5)) {
                clasif1 = 'Marginal';
            }

            let clasif2 = 'Inadecuado';
            if (ll <= 30 && ip <= 10 && mo <= 0.2 && hinchamiento <= 0.2) {
                clasif2 = 'Seleccionado';
            } else if (ll <= 40 && ip <= Math.max(lineA, 4) && mo <= 1 && hinchamiento <= 0.2) {
                clasif2 = 'Adecuado';
            } else if (ll <= 65 && ip <= Math.max(lineA, 0) && mo <= 2 && hinchamiento <= 2.5) {
                clasif2 = 'Tolerable';
            } else if (ll <= 90 && ip <= (lineA + 5) && mo <= 5 && hinchamiento <= 2.0) {
                clasif2 = 'Marginal';
            }

            // Orden de clasificaci√≥n: 0=Seleccionado (mejor), 4=Inadecuado (peor)
            const orden = { 'Seleccionado': 0, 'Adecuado': 1, 'Tolerable': 2, 'Marginal': 3, 'Inadecuado': 4 };
            // El PEOR resultado es el que tiene el n√∫mero M√ÅS ALTO
            const peor = orden[clasif1] >= orden[clasif2] ? clasif1 : clasif2;

            return {
                clasificacion: peor,
                metodo1: clasif1,
                metodo2: clasif2,
                lineA: lineA
            };
        }

        // Dibujar gr√°fica con Chart.js
        function dibujarGrafica() {
            const ll = parseFloat(llInput.value) || 0;
            const ip = parseFloat(ipCalculado.value) || 0;

            // Generar puntos para la L√≠nea A
            const lineAPoints = [];
            for (let x = 20; x <= 100; x += 1) {
                lineAPoints.push({
                    x: x,
                    y: 0.73 * (x - 20)
                });
            }

            // Zonas de fondo (usando plugins de Chart.js)
            const chartConfig = {
                type: 'scatter',
                data: {
                    datasets: [
                        // Zona SELECCIONADA
                        {
                            label: 'Seleccionados',
                            data: [{x: 0, y: 0}, {x: 30, y: 0}, {x: 30, y: 10}, {x: 0, y: 10}, {x: 0, y: 0}],
                            fill: true,
                            backgroundColor: 'rgba(33, 128, 141, 0.25)',
                            borderColor: 'rgba(33, 128, 141, 0.5)',
                            borderWidth: 1.5,
                            pointRadius: 0,
                            showLine: true,
                            tension: 0
                        },
                        // Zona ADECUADA
                        {
                            label: 'Adecuados',
                            data: [{x: 30, y: 0}, {x: 40, y: 0}, {x: 40, y: 14.6}, {x: 30, y: 10}, {x: 30, y: 0}],
                            fill: true,
                            backgroundColor: 'rgba(34, 197, 94, 0.25)',
                            borderColor: 'rgba(34, 197, 94, 0.5)',
                            borderWidth: 1.5,
                            pointRadius: 0,
                            showLine: true,
                            tension: 0
                        },
                        // Zona TOLERABLE
                        {
                            label: 'Tolerables',
                            data: [{x: 40, y: 0}, {x: 65, y: 0}, {x: 65, y: 32.9}, {x: 40, y: 14.6}, {x: 40, y: 0}],
                            fill: true,
                            backgroundColor: 'rgba(234, 179, 8, 0.25)',
                            borderColor: 'rgba(234, 179, 8, 0.5)',
                            borderWidth: 1.5,
                            pointRadius: 0,
                            showLine: true,
                            tension: 0
                        },
                        // Zona MARGINAL
                        {
                            label: 'Marginales',
                            data: [{x: 65, y: 0}, {x: 90, y: 0}, {x: 90, y: 51.1}, {x: 65, y: 32.9}, {x: 65, y: 0}],
                            fill: true,
                            backgroundColor: 'rgba(168, 75, 47, 0.25)',
                            borderColor: 'rgba(168, 75, 47, 0.5)',
                            borderWidth: 1.5,
                            pointRadius: 0,
                            showLine: true,
                            tension: 0
                        },
                        // L√≠nea A
                        {
                            label: 'L√≠nea A: IP = 0.73(LL - 20)',
                            data: lineAPoints,
                            borderColor: '#000',
                            borderWidth: 2.5,
                            pointRadius: 0,
                            showLine: true,
                            fill: false,
                            tension: 0
                        },
                        // Punto actual
                        {
                            label: 'Suelo Actual',
                            data: ll > 0 && ip >= 0 ? [{x: ll, y: ip}] : [],
                            pointRadius: 8,
                            pointBackgroundColor: '#d32f2f',
                            pointBorderColor: '#8b0000',
                            pointBorderWidth: 2.5,
                            showLine: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                font: {
                                    size: 12,
                                    weight: '500'
                                },
                                padding: 15,
                                color: '#333'
                            }
                        },
                        tooltip: {
                            enabled: true,
                            mode: 'point',
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            padding: 10,
                            titleFont: { size: 12, weight: 'bold' },
                            bodyFont: { size: 11 },
                            cornerRadius: 4,
                            displayColors: false
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            min: 0,
                            max: 100,
                            ticks: {
                                stepSize: 10,
                                font: { size: 11 },
                                color: '#666'
                            },
                            grid: {
                                color: 'rgba(200, 200, 200, 0.2)',
                                drawBorder: true,
                                borderColor: '#333'
                            },
                            title: {
                                display: true,
                                text: 'LL (L√≠mite L√≠quido %)',
                                font: { size: 13, weight: 'bold' },
                                color: '#333',
                                padding: 12
                            }
                        },
                        y: {
                            min: 0,
                            max: 80,
                            ticks: {
                                stepSize: 10,
                                font: { size: 11 },
                                color: '#666'
                            },
                            grid: {
                                color: 'rgba(200, 200, 200, 0.2)',
                                drawBorder: true,
                                borderColor: '#333'
                            },
                            title: {
                                display: true,
                                text: 'IP (√çndice Plasticidad %)',
                                font: { size: 13, weight: 'bold' },
                                color: '#333',
                                padding: 12
                            }
                        }
                    }
                }
            };

            if (chartInstance) {
                chartInstance.data = chartConfig.data;
                chartInstance.options = chartConfig.options;
                chartInstance.update();
            } else {
                chartInstance = new Chart(chartCanvas, chartConfig);
            }
        }

        // Env√≠o del formulario
        form.addEventListener('submit', function(e) {
            e.preventDefault();

            const nombre = document.getElementById('nombre').value;
            const ll = parseFloat(llInput.value);
            const ip = parseFloat(ipCalculado.value);
            const lp = parseFloat(lpInput.value) || ll - ip;
            const mo = parseFloat(document.getElementById('mo').value);
            const ss = parseFloat(document.getElementById('ss').value);
            const hinchamiento = parseFloat(document.getElementById('hinchamiento').value);
            const finos = parseFloat(document.getElementById('sieve-008').value);
            const cbr = parseFloat(document.getElementById('cbr').value);

            if (!finos) {
                alert('Por favor introduce el valor de Finos (# 0.08)');
                return;
            }

            const resultado = clasificarSuelo(ll, lp, ip, mo, ss, hinchamiento, finos, cbr);
            
            const suelo = {
                id: Date.now(),
                nombre,
                ll, lp, ip, mo, ss, hinchamiento, finos, cbr,
                clasificacion: resultado.clasificacion,
                fecha: new Date().toLocaleString('es-ES')
            };

            suelos.unshift(suelo);
            suloActual = suelo;

            document.getElementById('classResult').textContent = resultado.clasificacion;
            document.getElementById('classDetails').innerHTML = `
                <div>M√©todo 1 (Tabla): <strong>${resultado.metodo1}</strong></div>
                <div>M√©todo 2 (Gr√°fica): <strong>${resultado.metodo2}</strong></div>
                <div style="margin-top: 8px; border-top: 1px solid rgba(33, 128, 141, 0.2); padding-top: 8px;">
                    <strong>Peor resultado (clasificaci√≥n final):</strong> ${resultado.clasificacion}
                </div>
            `;
            document.getElementById('resultado').classList.add('visible');

            actualizarTabla();
            dibujarGrafica();
        });

        function actualizarTabla() {
            const container = document.getElementById('tabla-container');

            if (suelos.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>No hay suelos clasificados a√∫n.</p></div>';
                return;
            }

            let html = `
                <table>
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>LL</th>
                            <th>LP</th>
                            <th>IP</th>
                            <th>MO</th>
                            <th>SS</th>
                            <th>Hinchamiento</th>
                            <th>Finos</th>
                            <th>CBR</th>
                            <th>Clasificaci√≥n</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            suelos.forEach(suelo => {
                const badge = `badge-${suelo.clasificacion.toLowerCase()}`;
                html += `
                    <tr>
                        <td><strong>${suelo.nombre}</strong></td>
                        <td>${suelo.ll}</td>
                        <td>${suelo.lp.toFixed(1)}</td>
                        <td>${suelo.ip.toFixed(1)}</td>
                        <td>${suelo.mo}</td>
                        <td>${suelo.ss}</td>
                        <td>${suelo.hinchamiento}</td>
                        <td>${suelo.finos}</td>
                        <td>${suelo.cbr}</td>
                        <td><span class="badge ${badge}">${suelo.clasificacion}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-sm" onclick="copiarSuelo(${suelo.id})" title="Copiar">üìã</button>
                                <button class="btn-sm" onclick="editarSuelo(${suelo.id})" title="Editar">‚úèÔ∏è</button>
                                <button class="btn-sm btn-delete" onclick="eliminarSuelo(${suelo.id})" title="Eliminar">üóëÔ∏è</button>
                            </div>
                        </td>
                    </tr>
                `;
            });

            html += `
                    </tbody>
                </table>
            `;

            container.innerHTML = html;
        }

        function copiarSuelo(id) {
            const suelo = suelos.find(s => s.id === id);
            if (suelo) {
                document.getElementById('nombre').value = suelo.nombre + ' (copia)';
                llInput.value = suelo.ll;
                ipInput.value = suelo.ip;
                document.getElementById('mo').value = suelo.mo;
                document.getElementById('ss').value = suelo.ss;
                document.getElementById('hinchamiento').value = suelo.hinchamiento;
                document.getElementById('sieve-008').value = suelo.finos;
                document.getElementById('cbr').value = suelo.cbr;
                calcularPlasticidad();
                window.scrollTo({top: 0, behavior: 'smooth'});
            }
        }

        function editarSuelo(id) {
            const suelo = suelos.find(s => s.id === id);
            if (suelo) {
                document.getElementById('nombre').value = suelo.nombre;
                llInput.value = suelo.ll;
                ipInput.value = suelo.ip;
                document.getElementById('mo').value = suelo.mo;
                document.getElementById('ss').value = suelo.ss;
                document.getElementById('hinchamiento').value = suelo.hinchamiento;
                document.getElementById('sieve-008').value = suelo.finos;
                document.getElementById('cbr').value = suelo.cbr;
                calcularPlasticidad();
                eliminarSuelo(id);
                window.scrollTo({top: 0, behavior: 'smooth'});
            }
        }

        function eliminarSuelo(id) {
            suelos = suelos.filter(s => s.id !== id);
            actualizarTabla();
            document.getElementById('resultado').classList.remove('visible');
        }

        // Inicializar
        dibujarGrafica();
        actualizarTabla();
    </script>
</body>
</html>
